<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/05/24/hello-world/"/>
      <url>/2022/05/24/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><div class="story post-story"><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p></div>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ezam</title>
      <link href="/2022/05/24/ezam%EF%BC%88ollvm%20%E8%BF%B7%E5%AE%AB%20%E8%BF%9B%E5%88%B6%EF%BC%89/"/>
      <url>/2022/05/24/ezam%EF%BC%88ollvm%20%E8%BF%B7%E5%AE%AB%20%E8%BF%9B%E5%88%B6%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>题目打开<br /></p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082339933.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082339933.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p><br />标准的ollvm混肴，用脚本两次去除<br /></p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082339395.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082339395.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br /><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082339683.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082339683.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br /></p><p>得到正常的程序<br /></p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082340650.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082340650.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p><br /><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082343947.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082343947.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br />初步分析是以为多项式相加，疏忽了v17以及前面一大段数据的初始化。想着用z3硬解失败了。<br />主要逻辑为读取输入，判断是否为数字，然后转换成四进制，走迷宫。<br />前面的一大段加密是初始化迷宫地图v17，我们可以动调得到一个16*28的迷宫：（做题多尝试</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span></span><br></pre></td></tr></table></figure><p>下面看一下 sub_400670 函数 ，结合动调，是十进制转四进制算法。<br /><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082342374.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082342374.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br />下面就是迷宫出走方式<br /><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082342140.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082342140.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br />得到两条路径，根据函数判断路径长度是45，所以是上面那条<br />232222322330030000303322223333333222233333333<br />232222322330030000303322222222222333333300033333333<br />然后四进制转十进制得到flag</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">def <span class="title">anyToDecimal</span><span class="params">(num,n)</span>:</span></span><br><span class="line"><span class="function">   baseStr =</span> &#123;<span class="string">&quot;0&quot;</span>:<span class="number">0</span>,<span class="string">&quot;1&quot;</span>:<span class="number">1</span>,<span class="string">&quot;2&quot;</span>:<span class="number">2</span>,<span class="string">&quot;3&quot;</span>:<span class="number">3</span>,<span class="string">&quot;4&quot;</span>:<span class="number">4</span>,<span class="string">&quot;5&quot;</span>:<span class="number">5</span>,<span class="string">&quot;6&quot;</span>:<span class="number">6</span>,<span class="string">&quot;7&quot;</span>:<span class="number">7</span>,<span class="string">&quot;8&quot;</span>:<span class="number">8</span>,<span class="string">&quot;9&quot;</span>:<span class="number">9</span>,</span><br><span class="line">              <span class="string">&quot;a&quot;</span>:<span class="number">10</span>,<span class="string">&quot;b&quot;</span>:<span class="number">11</span>,<span class="string">&quot;c&quot;</span>:<span class="number">12</span>,<span class="string">&quot;d&quot;</span>:<span class="number">13</span>,<span class="string">&quot;e&quot;</span>:<span class="number">14</span>,<span class="string">&quot;f&quot;</span>:<span class="number">15</span>,<span class="string">&quot;g&quot;</span>:<span class="number">16</span>,<span class="string">&quot;h&quot;</span>:<span class="number">17</span>,<span class="string">&quot;i&quot;</span>:<span class="number">18</span>,<span class="string">&quot;j&quot;</span>:<span class="number">19</span>&#125;</span><br><span class="line">   new_num = <span class="number">0</span></span><br><span class="line">   nNum = <span class="built_in">len</span>(num) - <span class="number">1</span></span><br><span class="line">   <span class="keyword">for</span> i in num:</span><br><span class="line">       new_num = new_num  + baseStr[i]*<span class="built_in">pow</span>(n,nNum)</span><br><span class="line">       nNum = nNum <span class="number">-1</span></span><br><span class="line">   <span class="built_in">print</span>(new_num)</span><br><span class="line"></span><br><span class="line"><span class="built_in">anyToDecimal</span>(<span class="string">&#x27;232222322330030000303322223333333222233333333&#x27;</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure><p> flag{902741462666576198076399615}</p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> -迷宫 -进制 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>末日邀请</title>
      <link href="/2022/05/24/KCTF-%E6%9C%AB%E6%97%A5%E9%82%80%E8%AF%B7%EF%BC%88%E5%8A%A0%E5%AF%86%E9%97%AF%E5%85%B3%EF%BC%89/"/>
      <url>/2022/05/24/KCTF-%E6%9C%AB%E6%97%A5%E9%82%80%E8%AF%B7%EF%BC%88%E5%8A%A0%E5%AF%86%E9%97%AF%E5%85%B3%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>先是输入flag也就是ID，然后进行check，主要考察算法。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205151944388.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205151944388.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>对我们的输入进行一系列异或，最后赋值给v39，注意这里v39类型是char，接着进行sbox数据初始化，</p><p>然后进行CRC32验证，这里可以动调取到flag，这里v34的值后面会给出并进行验证。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205151954909.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205151954909.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>接着先将字符转成数值，存入内存，并且如果大于58就减去55.接着用冰雹猜想验证输入的前三位。我们可以爆破得到v17的值是定值7.具体前三位先按下不表</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152014418.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152014418.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>爆破代码：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> i; <span class="comment">// edx</span></span><br><span class="line"><span class="type">int</span> v13; <span class="comment">// ecx</span></span><br><span class="line"><span class="type">int</span> v15; <span class="comment">// eax</span></span><br><span class="line"><span class="type">int</span> j; <span class="comment">// edx</span></span><br><span class="line"><span class="type">int</span> v17; <span class="comment">// edi</span></span><br><span class="line"><span class="type">int</span> v33[<span class="number">200</span>]; <span class="comment">// [esp+10h] [ebp-368h]</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">0xff</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v13 = i;</span><br><span class="line">        v15 = v13;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt; <span class="number">200</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((v15 &amp; <span class="number">1</span>) != <span class="number">0</span>)                     <span class="comment">// 奇数*3+1</span></span><br><span class="line">                v15 = <span class="number">3</span> * v15 + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                v15 &gt;&gt;= <span class="number">1</span>;                              <span class="comment">// 偶数右移1</span></span><br><span class="line">            v33[j] = v15;</span><br><span class="line">        &#125;</span><br><span class="line">        v17 = v33[<span class="number">198</span>] | v33[<span class="number">197</span>] | v33[<span class="number">196</span>];</span><br><span class="line">        cout &lt;&lt; v17 &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>后面就是判断后四位是否为KCTF</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152022192.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152022192.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>动调发现是v41[1]是输入的第8个字符，推测后面还需要验证九位，然后进行取余验证，依次取最高前i位，看是否能取余i，不能则失败。但是后面对这里有一个约束。先是冒泡排序从小到大排序，然后对比1<del>9，也就是必须包含1</del>9每个数字</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152025132.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152025132.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152036244.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152036244.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>爆破取得这九位：381654729</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000000</span>,<span class="number">1000000000</span>):</span><br><span class="line">    <span class="keyword">if</span> i//<span class="number">10000000</span> %<span class="number">2</span> == <span class="number">0</span> <span class="keyword">and</span> i//<span class="number">1000000</span>%<span class="number">3</span> == <span class="number">0</span> <span class="keyword">and</span> i//<span class="number">100000</span>%<span class="number">4</span> == <span class="number">0</span> <span class="keyword">and</span> i//<span class="number">10000</span>%<span class="number">5</span> == <span class="number">0</span> <span class="keyword">and</span> i//<span class="number">1000</span> %<span class="number">6</span> == <span class="number">0</span> <span class="keyword">and</span> i//<span class="number">100</span> % <span class="number">7</span> == <span class="number">0</span> <span class="keyword">and</span> i//<span class="number">10</span> % <span class="number">8</span> == <span class="number">0</span> <span class="keyword">and</span> i%<span class="number">9</span> == <span class="number">0</span>:</span><br><span class="line">        num_all = <span class="built_in">str</span>(i)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;1&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;2&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;3&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;4&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;5&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;6&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;7&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;8&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;9&quot;</span> <span class="keyword">in</span> num_all :</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><p>最后就是判断v34是否相等 也就是前三位</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152049128.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152049128.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>爆破得到前三位：421</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">uint32_t</span> magic_arr[] = &#123;<span class="number">0x00000000</span>, <span class="number">0x09073096</span>, <span class="number">0x120E612C</span>, <span class="number">0x1B0951BA</span>, <span class="number">0xFF6DC419</span>, <span class="number">0xF66AF48F</span>, <span class="number">0xED63A535</span>, <span class="number">0xE46495A3</span>,</span><br><span class="line">                        <span class="number">0xFEDB8832</span>, <span class="number">0xF7DCB8A4</span>, <span class="number">0xECD5E91E</span>, <span class="number">0xE5D2D988</span>, <span class="number">0x01B64C2B</span>, <span class="number">0x08B17CBD</span>, <span class="number">0x13B82D07</span>, <span class="number">0x1ABF1D91</span>,</span><br><span class="line">                        <span class="number">0xFDB71064</span>, <span class="number">0xF4B020F2</span>, <span class="number">0xEFB97148</span>, <span class="number">0xE6BE41DE</span>, <span class="number">0x02DAD47D</span>, <span class="number">0x0BDDE4EB</span>, <span class="number">0x10D4B551</span>, <span class="number">0x19D385C7</span>,</span><br><span class="line">                        <span class="number">0x036C9856</span>, <span class="number">0x0A6BA8C0</span>, <span class="number">0x1162F97A</span>, <span class="number">0x1865C9EC</span>, <span class="number">0xFC015C4F</span>, <span class="number">0xF5066CD9</span>, <span class="number">0xEE0F3D63</span>, <span class="number">0xE7080DF5</span>,</span><br><span class="line">                        <span class="number">0xFB6E20C8</span>, <span class="number">0xF269105E</span>, <span class="number">0xE96041E4</span>, <span class="number">0xE0677172</span>, <span class="number">0x0403E4D1</span>, <span class="number">0x0D04D447</span>, <span class="number">0x160D85FD</span>, <span class="number">0x1F0AB56B</span>,</span><br><span class="line">                        <span class="number">0x05B5A8FA</span>, <span class="number">0x0CB2986C</span>, <span class="number">0x17BBC9D6</span>, <span class="number">0x1EBCF940</span>, <span class="number">0xFAD86CE3</span>, <span class="number">0xF3DF5C75</span>, <span class="number">0xE8D60DCF</span>, <span class="number">0xE1D13D59</span>,</span><br><span class="line">                        <span class="number">0x06D930AC</span>, <span class="number">0x0FDE003A</span>, <span class="number">0x14D75180</span>, <span class="number">0x1DD06116</span>, <span class="number">0xF9B4F4B5</span>, <span class="number">0xF0B3C423</span>, <span class="number">0xEBBA9599</span>, <span class="number">0xE2BDA50F</span>,</span><br><span class="line">                        <span class="number">0xF802B89E</span>, <span class="number">0xF1058808</span>, <span class="number">0xEA0CD9B2</span>, <span class="number">0xE30BE924</span>, <span class="number">0x076F7C87</span>, <span class="number">0x0E684C11</span>, <span class="number">0x15611DAB</span>, <span class="number">0x1C662D3D</span>,</span><br><span class="line">                        <span class="number">0xF6DC4190</span>, <span class="number">0xFFDB7106</span>, <span class="number">0xE4D220BC</span>, <span class="number">0xEDD5102A</span>, <span class="number">0x09B18589</span>, <span class="number">0x00B6B51F</span>, <span class="number">0x1BBFE4A5</span>, <span class="number">0x12B8D433</span>,</span><br><span class="line">                        <span class="number">0x0807C9A2</span>, <span class="number">0x0100F934</span>, <span class="number">0x1A09A88E</span>, <span class="number">0x130E9818</span>, <span class="number">0xF76A0DBB</span>, <span class="number">0xFE6D3D2D</span>, <span class="number">0xE5646C97</span>, <span class="number">0xEC635C01</span>,</span><br><span class="line">                        <span class="number">0x0B6B51F4</span>, <span class="number">0x026C6162</span>, <span class="number">0x196530D8</span>, <span class="number">0x1062004E</span>, <span class="number">0xF40695ED</span>, <span class="number">0xFD01A57B</span>, <span class="number">0xE608F4C1</span>, <span class="number">0xEF0FC457</span>,</span><br><span class="line">                        <span class="number">0xF5B0D9C6</span>, <span class="number">0xFCB7E950</span>, <span class="number">0xE7BEB8EA</span>, <span class="number">0xEEB9887C</span>, <span class="number">0x0ADD1DDF</span>, <span class="number">0x03DA2D49</span>, <span class="number">0x18D37CF3</span>, <span class="number">0x11D44C65</span>,</span><br><span class="line">                        <span class="number">0x0DB26158</span>, <span class="number">0x04B551CE</span>, <span class="number">0x1FBC0074</span>, <span class="number">0x16BB30E2</span>, <span class="number">0xF2DFA541</span>, <span class="number">0xFBD895D7</span>, <span class="number">0xE0D1C46D</span>, <span class="number">0xE9D6F4FB</span>,</span><br><span class="line">                        <span class="number">0xF369E96A</span>, <span class="number">0xFA6ED9FC</span>, <span class="number">0xE1678846</span>, <span class="number">0xE860B8D0</span>, <span class="number">0x0C042D73</span>, <span class="number">0x05031DE5</span>, <span class="number">0x1E0A4C5F</span>, <span class="number">0x170D7CC9</span>,</span><br><span class="line">                        <span class="number">0xF005713C</span>, <span class="number">0xF90241AA</span>, <span class="number">0xE20B1010</span>, <span class="number">0xEB0C2086</span>, <span class="number">0x0F68B525</span>, <span class="number">0x066F85B3</span>, <span class="number">0x1D66D409</span>, <span class="number">0x1461E49F</span>,</span><br><span class="line">                        <span class="number">0x0EDEF90E</span>, <span class="number">0x07D9C998</span>, <span class="number">0x1CD09822</span>, <span class="number">0x15D7A8B4</span>, <span class="number">0xF1B33D17</span>, <span class="number">0xF8B40D81</span>, <span class="number">0xE3BD5C3B</span>, <span class="number">0xEABA6CAD</span>,</span><br><span class="line">                        <span class="number">0xEDB88320</span>, <span class="number">0xE4BFB3B6</span>, <span class="number">0xFFB6E20C</span>, <span class="number">0xF6B1D29A</span>, <span class="number">0x12D54739</span>, <span class="number">0x1BD277AF</span>, <span class="number">0x00DB2615</span>, <span class="number">0x09DC1683</span>,</span><br><span class="line">                        <span class="number">0x13630B12</span>, <span class="number">0x1A643B84</span>, <span class="number">0x016D6A3E</span>, <span class="number">0x086A5AA8</span>, <span class="number">0xEC0ECF0B</span>, <span class="number">0xE509FF9D</span>, <span class="number">0xFE00AE27</span>, <span class="number">0xF7079EB1</span>,</span><br><span class="line">                        <span class="number">0x100F9344</span>, <span class="number">0x1908A3D2</span>, <span class="number">0x0201F268</span>, <span class="number">0x0B06C2FE</span>, <span class="number">0xEF62575D</span>, <span class="number">0xE66567CB</span>, <span class="number">0xFD6C3671</span>, <span class="number">0xF46B06E7</span>,</span><br><span class="line">                        <span class="number">0xEED41B76</span>, <span class="number">0xE7D32BE0</span>, <span class="number">0xFCDA7A5A</span>, <span class="number">0xF5DD4ACC</span>, <span class="number">0x11B9DF6F</span>, <span class="number">0x18BEEFF9</span>, <span class="number">0x03B7BE43</span>, <span class="number">0x0AB08ED5</span>,</span><br><span class="line">                        <span class="number">0x16D6A3E8</span>, <span class="number">0x1FD1937E</span>, <span class="number">0x04D8C2C4</span>, <span class="number">0x0DDFF252</span>, <span class="number">0xE9BB67F1</span>, <span class="number">0xE0BC5767</span>, <span class="number">0xFBB506DD</span>, <span class="number">0xF2B2364B</span>,</span><br><span class="line">                        <span class="number">0xE80D2BDA</span>, <span class="number">0xE10A1B4C</span>, <span class="number">0xFA034AF6</span>, <span class="number">0xF3047A60</span>, <span class="number">0x1760EFC3</span>, <span class="number">0x1E67DF55</span>, <span class="number">0x056E8EEF</span>, <span class="number">0x0C69BE79</span>,</span><br><span class="line">                        <span class="number">0xEB61B38C</span>, <span class="number">0xE266831A</span>, <span class="number">0xF96FD2A0</span>, <span class="number">0xF068E236</span>, <span class="number">0x140C7795</span>, <span class="number">0x1D0B4703</span>, <span class="number">0x060216B9</span>, <span class="number">0x0F05262F</span>,</span><br><span class="line">                        <span class="number">0x15BA3BBE</span>, <span class="number">0x1CBD0B28</span>, <span class="number">0x07B45A92</span>, <span class="number">0x0EB36A04</span>, <span class="number">0xEAD7FFA7</span>, <span class="number">0xE3D0CF31</span>, <span class="number">0xF8D99E8B</span>, <span class="number">0xF1DEAE1D</span>,</span><br><span class="line">                        <span class="number">0x1B64C2B0</span>, <span class="number">0x1263F226</span>, <span class="number">0x096AA39C</span>, <span class="number">0x006D930A</span>, <span class="number">0xE40906A9</span>, <span class="number">0xED0E363F</span>, <span class="number">0xF6076785</span>, <span class="number">0xFF005713</span>,</span><br><span class="line">                        <span class="number">0xE5BF4A82</span>, <span class="number">0xECB87A14</span>, <span class="number">0xF7B12BAE</span>, <span class="number">0xFEB61B38</span>, <span class="number">0x1AD28E9B</span>, <span class="number">0x13D5BE0D</span>, <span class="number">0x08DCEFB7</span>, <span class="number">0x01DBDF21</span>,</span><br><span class="line">                        <span class="number">0xE6D3D2D4</span>, <span class="number">0xEFD4E242</span>, <span class="number">0xF4DDB3F8</span>, <span class="number">0xFDDA836E</span>, <span class="number">0x19BE16CD</span>, <span class="number">0x10B9265B</span>, <span class="number">0x0BB077E1</span>, <span class="number">0x02B74777</span>,</span><br><span class="line">                        <span class="number">0x18085AE6</span>, <span class="number">0x110F6A70</span>, <span class="number">0x0A063BCA</span>, <span class="number">0x03010B5C</span>, <span class="number">0xE7659EFF</span>, <span class="number">0xEE62AE69</span>, <span class="number">0xF56BFFD3</span>, <span class="number">0xFC6CCF45</span>,</span><br><span class="line">                        <span class="number">0xE00AE278</span>, <span class="number">0xE90DD2EE</span>, <span class="number">0xF2048354</span>, <span class="number">0xFB03B3C2</span>, <span class="number">0x1F672661</span>, <span class="number">0x166016F7</span>, <span class="number">0x0D69474D</span>, <span class="number">0x046E77DB</span>,</span><br><span class="line">                        <span class="number">0x1ED16A4A</span>, <span class="number">0x17D65ADC</span>, <span class="number">0x0CDF0B66</span>, <span class="number">0x05D83BF0</span>, <span class="number">0xE1BCAE53</span>, <span class="number">0xE8BB9EC5</span>, <span class="number">0xF3B2CF7F</span>, <span class="number">0xFAB5FFE9</span>,</span><br><span class="line">                        <span class="number">0x1DBDF21C</span>, <span class="number">0x14BAC28A</span>, <span class="number">0x0FB39330</span>, <span class="number">0x06B4A3A6</span>, <span class="number">0xE2D03605</span>, <span class="number">0xEBD70693</span>, <span class="number">0xF0DE5729</span>, <span class="number">0xF9D967BF</span>,</span><br><span class="line">                        <span class="number">0xE3667A2E</span>, <span class="number">0xEA614AB8</span>, <span class="number">0xF1681B02</span>, <span class="number">0xF86F2B94</span>, <span class="number">0x1C0BBE37</span>, <span class="number">0x150C8EA1</span>, <span class="number">0x0E05DF1B</span>, <span class="number">0x0702EF8D</span>&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="type">char</span> cstr[] = <span class="string">&quot;...KCTF381654729&quot;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0x20</span>; i &lt; <span class="number">0x7e</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0x20</span>; j &lt; <span class="number">0x7e</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0x20</span>; k &lt; <span class="number">0x7e</span>; k++) &#123;</span><br><span class="line">                cstr[<span class="number">0</span>] = i;</span><br><span class="line">                cstr[<span class="number">1</span>] = j;</span><br><span class="line">                cstr[<span class="number">2</span>] = k;</span><br><span class="line">                <span class="type">int32_t</span> v11 = <span class="number">-1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> idx = <span class="number">0</span>; idx &lt; <span class="number">16</span>; idx++) &#123;</span><br><span class="line">                    v11 = magic_arr[(<span class="type">uint8_t</span>)(v11 ^ cstr[idx])] ^ (v11 &gt;&gt; <span class="number">8</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ((~v11) == <span class="number">0xF52E0765</span>) &#123;  </span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%c %c %c\n&quot;</span>, i, j, k);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后的flag:421KCTF381654729</p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> -加解密 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
