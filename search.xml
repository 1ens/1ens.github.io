<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>dropper</title>
      <link href="/2022/06/29/dropper/"/>
      <url>/2022/06/29/dropper/</url>
      
        <content type="html"><![CDATA[<p>Dropper</p><p><a href="https://zhuanlan.zhihu.com/p/453020222">什么是Dropper</a></p><p>Dropper是将程序嵌入到自己的内部。</p><p>类似于双进程，运行后解密了资源表的数据，本题是一个exe文件，然后作为子进程被创建了</p><h1 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h1><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292122746.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292122746.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p> 开始一个UPX壳，upx -d 的话无法运行 ，手动去壳,试了很多遍， rax会运行错误。</p><p>静态分析：</p><p>（如果不给题目名称如何看出是dropper技术</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292129407.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292129407.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>进入，上面几个qword是函数调用但是识别失败。最后一个异或0x73，解密资源的地方，接着主程序后面就是创建一个进程，并把刚刚解密出的pe文件手动装载进行内存，然后恢复执行。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292132808.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292132808.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>下面我们用<a href="https://github.com/glmcdona/Process-Dump">Process-Dump</a>来dump出子程序</p><p><a href="https://cloud.tencent.com/developer/article/1887268">如何使用Process Dump</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd64.exe -pid ****</span><br></pre></td></tr></table></figure><p>dump出我们需要的子程序，</p><p>主要逻辑为一个int a[500]的数组来实现这个大数的存储及运算</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292336175.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292336175.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>这里的第88行*14 通过交叉引用可以推断出是什么，其初始化在Sub_7FF7D0F21433, </p><p>将sub_7FF7D0F2167C的地址赋给前四个字节</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292348451.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292348451.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292336138.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292336138.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>sub_7FF7D0F2167C函数主要两个功能，对数值的转换，然后check</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292335337.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292335337.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>对大数的运算</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292341512.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206292341512.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>调试提取数据，有一个除0异常，直接跳过即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">enc = [<span class="number">0x000020F1</span>, <span class="number">0x00001DA9</span>, <span class="number">0x00000156</span>, <span class="number">0x00000B37</span>, <span class="number">0x000007C0</span>, <span class="number">0x0000066A</span>, <span class="number">0x000024E0</span>, <span class="number">0x00000D42</span>, <span class="number">0x00002077</span>, <span class="number">0x000007EC</span>, <span class="number">0x00001BA7</span>, <span class="number">0x00002071</span>, <span class="number">0x000000F8</span>, <span class="number">0x00000291</span>, <span class="number">0x000003DA</span>, <span class="number">0x0000157C</span>, <span class="number">0x00001EF4</span>, <span class="number">0x00002519</span>, <span class="number">0x00000C25</span>, <span class="number">0x00002062</span>, <span class="number">0x00002253</span>, <span class="number">0x00000640</span>, <span class="number">0x000008DF</span>, <span class="number">0x00001E34</span>, <span class="number">0x00002140</span>, <span class="number">0x00000F92</span>, <span class="number">0x0000039B</span>, <span class="number">0x0000126F</span>, <span class="number">0x00002403</span>, <span class="number">0x00000E65</span>, <span class="number">0x000001F0</span>, <span class="number">0x00001868</span>, <span class="number">0x0000016D</span>, <span class="number">0x000006B6</span>, <span class="number">0x00002214</span>, <span class="number">0x00001603</span>, <span class="number">0x00001925</span>, <span class="number">0x000016AE</span>, <span class="number">0x000012D0</span>, <span class="number">0x00001831</span>, <span class="number">0x0000018C</span>, <span class="number">0x00000BF7</span>, <span class="number">0x00000E97</span>, <span class="number">0x000000CE</span>, <span class="number">0x0000061C</span>, <span class="number">0x00000390</span>, <span class="number">0x000019E9</span>, <span class="number">0x000022A5</span>, <span class="number">0x00001601</span>, <span class="number">0x00001A1E</span>, <span class="number">0x000013D1</span>, <span class="number">0x00000DBC</span>, <span class="number">0x0000117D</span>, <span class="number">0x0000225F</span>, <span class="number">0x00002272</span>, <span class="number">0x0000007B</span>, <span class="number">0x000023E6</span>, <span class="number">0x0000069F</span>, <span class="number">0x000002D3</span>, <span class="number">0x00001BEF</span>, <span class="number">0x000003E6</span>, <span class="number">0x000017D4</span>, <span class="number">0x00002284</span>, <span class="number">0x000003B8</span>, <span class="number">0x00000251</span>, <span class="number">0x00001646</span>, <span class="number">0x00000176</span>, <span class="number">0x0000081E</span>, <span class="number">0x000024C3</span>, <span class="number">0x00001E85</span>, <span class="number">0x00001097</span>, <span class="number">0x00001264</span>, <span class="number">0x00000A34</span>, <span class="number">0x00001A3B</span>, <span class="number">0x00000FE7</span>, <span class="number">0x000026A6</span>, <span class="number">0x00001F43</span>, <span class="number">0x00001832</span>, <span class="number">0x000021AE</span>, <span class="number">0x0000023C</span>, <span class="number">0x000004C2</span>, <span class="number">0x00002585</span>, <span class="number">0x000017E7</span>, <span class="number">0x000015DD</span>, <span class="number">0x00002610</span>, <span class="number">0x00001B86</span>, <span class="number">0x00000D2A</span>, <span class="number">0x00000716</span>, <span class="number">0x00001C25</span>, <span class="number">0x00002099</span>]</span><br><span class="line">data = [[<span class="number">0x000024AC</span>, <span class="number">0x00000116</span>, <span class="number">0x000004F4</span>, <span class="number">0x00000B64</span>, <span class="number">0x00001DC3</span>, <span class="number">0x00001B4A</span>, <span class="number">0x000001B2</span>, <span class="number">0x00001FCE</span>, <span class="number">0x00000E81</span>, <span class="number">0x000025AB</span>, <span class="number">0x0000015B</span>, <span class="number">0x0000252D</span>, <span class="number">0x000002AC</span>, <span class="number">0x00000F77</span>, <span class="number">0x000022F5</span>, <span class="number">0x000019E3</span>, <span class="number">0x00001C53</span>, <span class="number">0x00000B66</span>, <span class="number">0x000011BC</span>, <span class="number">0x0000193A</span>],</span><br><span class="line">        [<span class="number">0x00000DC6</span>, <span class="number">0x00000854</span>, <span class="number">0x000015F5</span>, <span class="number">0x00002567</span>, <span class="number">0x000008FA</span>, <span class="number">0x00000E20</span>, <span class="number">0x00000807</span>, <span class="number">0x00001007</span>, <span class="number">0x000018CC</span>, <span class="number">0x00001E84</span>, <span class="number">0x00001F11</span>, <span class="number">0x000013D4</span>, <span class="number">0x0000076A</span>, <span class="number">0x00001461</span>, <span class="number">0x00000B0F</span>, <span class="number">0x00001F70</span>, <span class="number">0x00001B3D</span>, <span class="number">0x00001008</span>, <span class="number">0x00000D52</span>, <span class="number">0x0000049A</span>],</span><br><span class="line">        [<span class="number">0x00001A89</span>, <span class="number">0x00000E42</span>, <span class="number">0x000000FA</span>, <span class="number">0x0000100D</span>, <span class="number">0x000014DD</span>, <span class="number">0x00001BFC</span>, <span class="number">0x000026DB</span>, <span class="number">0x00001AC2</span>, <span class="number">0x00001CA0</span>, <span class="number">0x000005ED</span>, <span class="number">0x00000834</span>, <span class="number">0x000016BF</span>, <span class="number">0x00000704</span>, <span class="number">0x00001FAD</span>, <span class="number">0x000025FD</span>, <span class="number">0x00001142</span>, <span class="number">0x00001EEE</span>, <span class="number">0x00001E60</span>, <span class="number">0x00000353</span>, <span class="number">0x000015A8</span>],</span><br><span class="line">        [<span class="number">0x00000E17</span>, <span class="number">0x00000706</span>, <span class="number">0x00000C1F</span>, <span class="number">0x00000169</span>, <span class="number">0x00002248</span>, <span class="number">0x000007FD</span>, <span class="number">0x00001768</span>, <span class="number">0x00001F54</span>, <span class="number">0x00001574</span>, <span class="number">0x00002458</span>, <span class="number">0x00000374</span>, <span class="number">0x00001D6B</span>, <span class="number">0x00000918</span>, <span class="number">0x00000ECF</span>, <span class="number">0x0000211D</span>, <span class="number">0x00001D96</span>, <span class="number">0x00001BEB</span>, <span class="number">0x00001703</span>, <span class="number">0x00001B87</span>, <span class="number">0x000006FA</span>],</span><br><span class="line">        [<span class="number">0x00000AE3</span>, <span class="number">0x0000069F</span>, <span class="number">0x000001EF</span>, <span class="number">0x00001C15</span>, <span class="number">0x00001378</span>, <span class="number">0x000020D1</span>, <span class="number">0x0000211D</span>, <span class="number">0x00002275</span>, <span class="number">0x000005F4</span>, <span class="number">0x00002475</span>, <span class="number">0x00000D13</span>, <span class="number">0x000008EF</span>, <span class="number">0x00000E10</span>, <span class="number">0x000006D4</span>, <span class="number">0x0000215A</span>, <span class="number">0x000004D6</span>, <span class="number">0x0000202F</span>, <span class="number">0x00001B99</span>, <span class="number">0x00001C86</span>, <span class="number">0x000002F1</span>],</span><br><span class="line">        [<span class="number">0x00000680</span>, <span class="number">0x000000D4</span>, <span class="number">0x00000677</span>, <span class="number">0x00001E21</span>, <span class="number">0x0000220D</span>, <span class="number">0x00000933</span>, <span class="number">0x00000973</span>, <span class="number">0x00001947</span>, <span class="number">0x00000D61</span>, <span class="number">0x0000247F</span>, <span class="number">0x00001D21</span>, <span class="number">0x00001FA2</span>, <span class="number">0x00001606</span>, <span class="number">0x000007B0</span>, <span class="number">0x00001829</span>, <span class="number">0x000016C0</span>, <span class="number">0x000026C9</span>, <span class="number">0x0000248C</span>, <span class="number">0x00000C9A</span>, <span class="number">0x00001F8F</span>],</span><br><span class="line">        [<span class="number">0x0000257F</span>, <span class="number">0x00000359</span>, <span class="number">0x00001831</span>, <span class="number">0x000021B7</span>, <span class="number">0x00000BA8</span>, <span class="number">0x00000FC5</span>, <span class="number">0x00000BA4</span>, <span class="number">0x000024E2</span>, <span class="number">0x00001241</span>, <span class="number">0x00000D53</span>, <span class="number">0x00000C82</span>, <span class="number">0x00001240</span>, <span class="number">0x00002241</span>, <span class="number">0x00001156</span>, <span class="number">0x0000116A</span>, <span class="number">0x000005F3</span>, <span class="number">0x000022D5</span>, <span class="number">0x000008DA</span>, <span class="number">0x000014A3</span>, <span class="number">0x0000059E</span>],</span><br><span class="line">        [<span class="number">0x00001675</span>, <span class="number">0x00000AA9</span>, <span class="number">0x00000D8B</span>, <span class="number">0x00000D31</span>, <span class="number">0x00001722</span>, <span class="number">0x000006C8</span>, <span class="number">0x0000151B</span>, <span class="number">0x000017D8</span>, <span class="number">0x00001FEF</span>, <span class="number">0x00001624</span>, <span class="number">0x00002307</span>, <span class="number">0x00000CB9</span>, <span class="number">0x0000053C</span>, <span class="number">0x00000230</span>, <span class="number">0x00001EAA</span>, <span class="number">0x00001FD1</span>, <span class="number">0x00000FAD</span>, <span class="number">0x00001E30</span>, <span class="number">0x00002345</span>, <span class="number">0x00001583</span>],</span><br><span class="line">        [<span class="number">0x000001D1</span>, <span class="number">0x0000056E</span>, <span class="number">0x00000AA3</span>, <span class="number">0x0000223C</span>, <span class="number">0x000009A4</span>, <span class="number">0x000006C9</span>, <span class="number">0x00000112</span>, <span class="number">0x00001977</span>, <span class="number">0x00002512</span>, <span class="number">0x00000B60</span>, <span class="number">0x0000081A</span>, <span class="number">0x00000F06</span>, <span class="number">0x00001329</span>, <span class="number">0x000011AA</span>, <span class="number">0x00002404</span>, <span class="number">0x00000E57</span>, <span class="number">0x0000011E</span>, <span class="number">0x000011DC</span>, <span class="number">0x00002474</span>, <span class="number">0x00001BC7</span>],</span><br><span class="line">        [<span class="number">0x000022BE</span>, <span class="number">0x00001F17</span>, <span class="number">0x00000588</span>, <span class="number">0x00001B80</span>, <span class="number">0x00001479</span>, <span class="number">0x000016EF</span>, <span class="number">0x000008CA</span>, <span class="number">0x00000D6E</span>, <span class="number">0x0000138F</span>, <span class="number">0x00001054</span>, <span class="number">0x000021FA</span>, <span class="number">0x00000102</span>, <span class="number">0x000013A6</span>, <span class="number">0x00000195</span>, <span class="number">0x000002D1</span>, <span class="number">0x00002594</span>, <span class="number">0x00001369</span>, <span class="number">0x00002534</span>, <span class="number">0x000015C5</span>, <span class="number">0x0000168A</span>]]</span><br><span class="line">enc1 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc[::-<span class="number">1</span>]:</span><br><span class="line">    enc1 = enc1*<span class="number">10000</span>+i</span><br><span class="line">data1= [<span class="number">0</span>]*<span class="number">10</span></span><br><span class="line"><span class="keyword">for</span> i, val <span class="keyword">in</span> <span class="built_in">enumerate</span>(data): <span class="comment">#enumerate() 函数用于将一个可遍历的数据对象(如列表、元组或字符串)组合为一个索引序列，同时列出数据和数据下标，一般用在 for 循环当中</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> val[::-<span class="number">1</span>]:</span><br><span class="line">        data1[i] = data1[i]*<span class="number">10000</span>+j</span><br><span class="line">enc1 += data1[<span class="number">9</span>]</span><br><span class="line">enc1 -= data1[<span class="number">8</span>]</span><br><span class="line">enc1 += data1[<span class="number">7</span>]</span><br><span class="line">enc1 -= data1[<span class="number">6</span>]</span><br><span class="line">enc1 += data1[<span class="number">5</span>]</span><br><span class="line">enc1 //= data1[<span class="number">4</span>]</span><br><span class="line">enc1 -= data1[<span class="number">3</span>]</span><br><span class="line">enc1 += data1[<span class="number">2</span>]</span><br><span class="line">enc1 //= data1[<span class="number">1</span>]</span><br><span class="line">enc1 -= data1[<span class="number">0</span>]</span><br><span class="line">ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> enc1:</span><br><span class="line">    ans += <span class="built_in">chr</span>(enc1%<span class="number">128</span>)</span><br><span class="line">    enc1 //= <span class="number">128</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(ans))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> -[ACTF] -[dropper] </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>固件逆向分析初试</title>
      <link href="/2022/06/24/%E5%9B%BA%E4%BB%B6%E9%80%86%E5%90%91%E5%88%86%E6%9E%90%E5%88%9D%E8%AF%95/"/>
      <url>/2022/06/24/%E5%9B%BA%E4%BB%B6%E9%80%86%E5%90%91%E5%88%86%E6%9E%90%E5%88%9D%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206242008925.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206242008925.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">m</p><p>U-Boot(Universal Boot Loader)，即通用Bootloader，是德国DENX小组开发的用于多种嵌入式CPU的bootloader程序</p><p>Legacy-uImage<br>在kernel镜像的基础上，加上64Byte的信息提供给uboot使用</p><p>binwalk分析一下，是Squashfs文件系统</p><h1 id="Binwalk如何进行提取："><a href="#Binwalk如何进行提取：" class="headerlink" title="Binwalk如何进行提取："></a>Binwalk如何进行提取：</h1><p>通过maigc特征集与文件进行比对，但识别效率比file命令高多了</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206242016218.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206242016218.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>binwalk -Me 解压得到</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206242219239.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206242219239.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>文件系统是操作系统的重要组成部分，是操作运行的基础。不同的路由器使用的文件系统格式不尽相同。根文件系统会被打包成当前路由器所使用的文件系统格式，然后组装到固件中。路由器希望文件系统越小越好，所以这些文件系统中各种压缩格式随处可见。</p><p> Squashfs是一个只读格式的文件系统，具有超高压缩率，其压缩率最高可达34%。当系统启动后，会将文件系统保存在一个压缩过的文件系统文件中，这个文件可以使用换回的形式挂载并对其中的文件进行访问，当进程需要某些文件时，仅将对应部分的压缩文件解压缩。 </p><p>Squashfs文件系统常用的压缩格式有GZIP、LZMA、LZO、XZ（LZMA2）。路由器的根文件系统通常会按照Squashfs文件系统常用压缩格式中的一种进行打包，形成一个完整的Squashfs文件系统，然后与路由器操作系统的内核一起形成更新固件。 </p><p>由于squashFS可以在不需要解压的情况下直接挂载，因此有许多应用场景，例如： 1、安装Linux时用的live cd 2、小型嵌入式设备中的rootfs。rootfs一般以压缩好的形式存放在ROM中，如果开机时把整个rootfs都解压到内存里再读取，对于ROM和RAM容量一般都很小的小型嵌入式设备来说性价比太低。</p><h1 id="0x2-静态分析"><a href="#0x2-静态分析" class="headerlink" title="0x2 静态分析"></a>0x2 静态分析</h1><p>从Dlink固件里面提取样本，打开发现被加密了。</p><p>如生成字典用的crunch、rsmangler，爆破用的frackzip等</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301315538.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301315538.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>直接使用教程的密码beUT9Z，解压如下</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301342537.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301342537.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><ul><li>.mbn：高通的一套用于加载网络环境的文件（modem software configuration）</li><li>.yaffs2：针对NAND芯片设计的嵌入式文件系统，可用unyaffs提取</li></ul><p>核心应该是2K-mdm-image-mdm9625.yaffs2，用unyaffs提取</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unyaffs 2K-mdm-image-mdm9625.yaffs2 yaffs2-root/</span><br></pre></td></tr></table></figure><p>接下来我们查找该路径下的所有.conf文件，.conf文件多是配置文件，有可能从中可以发现敏感的信息。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -name &#x27;*.conf&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301404793.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301404793.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>其中的inadyn-mt.conf文件引起了我们注意，这是no-ip应用的配置文件，no-ip就是一个相当于花生壳的东西，可以申请动态域名。我们从中可以发现泄露的no-ip的登陆账号及密码。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301406307.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301406307.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>我们还从shadow文件中找到了root账号的密码，通过爆破可以得到root的密码为1234。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301409662.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301409662.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>接下来使用firmwalker来自动化遍历固件系统中的所有可疑文件。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/craigz28/firmwalker.git</span><br></pre></td></tr></table></figure><p>Firmwalker是一个bash脚本，用于扫描从IoT固件提取的文件以查看它们是否容易受到攻击。唯一的要求是该工具和提取的固件文件应位于同一文件夹中。</p><p>将它们放置在相同的位置后，由Firmwalker生成的输出文件-Firmwalker.text-将突出显示潜在问题的列表，可以是以下任意一个：</p><p>etc &#x2F; ssl目录<br>etc &#x2F; passwd和etc &#x2F; shadow<br>配置，脚本和其他.bin文件<br>关键字，例如远程，管理员，密码等。<br>常见的二进制文件，例如dropbear，tftp和ssh<br>物联网设备上存在的常见Web服务器<br>随机IP地址，电子邮件ID和URL<br>使用Shodan CLI调用Shodan API的实验功能<br>面临任何这些问题的所有物联网设备都容易受到攻击。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./firmwalker.sh yaffs2-root/   </span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301420639.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301420639.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>除了配置文件外，分析存在风险的二进制程序也很重要。查看自启动的程序，在etc&#x2F;init.d目录下存放启动时运行的程序和脚本，一个start_appmgr脚本引起了我们注意，mgr一般就是主控程序的意思。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301430753.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202206301430753.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>查看脚本，该脚本会在开机的时候以服务的形式运行&#x2F;bin&#x2F;appmgr程序。</p><p>用IDA打开该文件</p><p><img src="C:\Users\25858\AppData\Roaming\Typora\typora-user-images\image-20220630144831164.png" class="lazyload" data-srcset="C:\Users\25858\AppData\Roaming\Typora\typora-user-images\image-20220630144831164.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20220630144831164"></p><p>发现一个后门，这个漏洞被收录到<a href="https://pierrekim.github.io/blog/2016-09-28-dlink-dwr-932b-lte-routers-vulnerabilities.html">CVE-2016-10178</a></p><p>只要连接该固件的39889端口并发送HELODBG的字符串，就可以进行远程执行命令。</p>]]></content>
      
      
      <categories>
          
          <category> iot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 固件分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>你的状态不对</title>
      <link href="/2022/05/30/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"/>
      <url>/2022/05/30/%E7%A2%8E%E7%A2%8E%E5%BF%B5/</url>
      
        <content type="html"><![CDATA[<p> 我知道你的状态不对，希望你可以及时调整过来。</p><p>不要悲观，又或者静不下心来。</p><p>或者你又对这个世界充满了愤懑，又或者松懈了，没有按时完成自己的计划。</p><p>去洗个澡，去跑步，调整自己。</p><h1 id="不要太看重结果，尽力而为"><a href="#不要太看重结果，尽力而为" class="headerlink" title="不要太看重结果，尽力而为"></a>不要太看重结果，尽力而为</h1><p>“你太急切的想要一个答案了。想要风光的学位，瞬间的博学，想要意气风发，想闪着金光走向喜欢的人。但现实告诉我，操之过急便会败北，他要我等，要我耐得住不断延长的时间线，要我交付出足够的努力堆砌在沉闷、晦涩的时光里，才肯将一切“我想要”一点一点递送至我手里。“我知道你最近很累，是那种看不见的，身体上和精神上的疲惫感，但是请你一定要坚持下去。就算无人问津也好，技不如人也罢，千万别让烦恼和焦虑毁了你本就不多的热情和定力。</p><p>别贪心,我们不可能什么都有，别担心，我们也不可能什么都，没有。“不要再这样下去，一晚一晚的熬。想东想西，实在是矫情，真的该关掉手机，断了一些没必要的联系，扔掉所有负能量，认认真真的生活，再去做一些正儿八经的事儿。”“你要留点精力去读书去运动去爱人，去奔赴你想要的生活，不应该把精力浪费在痛苦的事情，看起来可以挽回的事情，仔细想想一点都不值得，贪恋过去的快乐注定走不远，过去的就让它.</p><p><a href="https://www.bilibili.com/medialist/play/ml281678891/BV1h34y1Y7UN?oid=810836008&otype=2">再见考研，再见我的二十一岁。 (bilibili.com)</a></p><p>你真的能做到吗，总得试试吧</p><p>站起来，去做出选择，去再一次挑战，去提升自己。不要留遗憾。</p><h1 id="李大仁送给程又青的方头狮"><a href="#李大仁送给程又青的方头狮" class="headerlink" title="李大仁送给程又青的方头狮"></a>李大仁送给程又青的方头狮</h1><p>与众不同的这件事，常常让它『卡住』，卡在『自己的原则里』</p><p>卡在『该不该妥协的挣扎里』、</p><p>卡在『会不会全世界都对了，只有我的坚持是错的迷失里……』</p><p>不要害怕自己的不一样，不要把约定陈俗当成信条，要勇敢的活出自己的精神！</p><p>正义、直率、聪明、磊落、还有你的不轻易妥协…</p><p>程又青就是这么独一无二</p><p>只是没有人懂，这或许也是别人觉得你最不完美的地方吧</p><p>永远支持你做自己！</p><p>永远尊重你的选择，不强迫你做不喜欢的事情。</p><h1 id="铁马冰河入梦来，心里的涛声彻夜的晃"><a href="#铁马冰河入梦来，心里的涛声彻夜的晃" class="headerlink" title="铁马冰河入梦来，心里的涛声彻夜的晃"></a>铁马冰河入梦来，心里的涛声彻夜的晃</h1><p>醒的异常的早，期末在即，却没有心思学下去，仿佛还没能从昨日的糟心事中走出来</p><p>给自己一点时间，你应该做的是去调整自己，以一个新的姿态，去迎接新的挑战。昨日已去</p><p>你现在一无所有，除了可以支配的时间，</p><p>现在是fw，但是以后不可以是。</p><p>好了，去做你该做的事情吧。</p>]]></content>
      
      
      <categories>
          
          <category> 杂谈 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 解语 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hack For Fun</title>
      <link href="/2022/05/29/Hack-for-fun/"/>
      <url>/2022/05/29/Hack-for-fun/</url>
      
        <content type="html"><![CDATA[<p>开一个新系列，解语。</p><p>有一些事情你自己得与自己和解。</p><p>没有章程，逻辑混乱，写给以后的自己。</p><p>尽人事，听天命，顺气自然。</p><p>或许这才是真实的fucking世界，或许你又遭遇到了一次失败，或许你又搞砸了一段感情，或许你又遭遇一次不公。</p><p>不要在意别人的目光，做人要有原则，不要把成绩看得太重要，做事尽力就好，剩下的交给天命。</p><p>在这个快餐时代，一切都变得急功近利，触碰到利益的事情就会有不公。</p><p>你该怎么办，是气馁，是愤懑，还是放弃，再一次看，你一定遇到挫折了吧。</p><p>世界上还有爱你的父母，一起的朋友，很多想要做的事情。</p><p>就像amazh👴说的 :“不要把成绩看的太重”</p><p>接管了社团，好像搞的一团糟，没有这方面的天赋。</p><p>失败是暂时的，真正的强者是如何面对失败.</p><p>下个星期，期末加油</p><p>之前的你已经不在，都停留在岁月里面，过好每一个明天，去成为更好的人类。</p><p>打ctf的意义是什么，为了奖项？为了成绩？ 都不是</p><p>提升自己才是最初的目的，菜就多学。希望早日成为带佬！！！</p><p>本来还有好多话要说，一时又想不起来</p><p>坚持自己的原则，花钱py真的没有必要，</p><p>​                                                   -2022 5 30 0.03</p>]]></content>
      
      
      <categories>
          
          <category> 杂谈 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 解语 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JIT</title>
      <link href="/2022/05/28/JIT/"/>
      <url>/2022/05/28/JIT/</url>
      
        <content type="html"><![CDATA[<h1 id="什么是JIT"><a href="#什么是JIT" class="headerlink" title="什么是JIT"></a>什么是JIT</h1><p>JIT &#x3D; Just In Time即时编译，是动态编译的一种形式，是一种优化<a href="https://so.csdn.net/so/search?q=%E8%99%9A%E6%8B%9F%E6%9C%BA&spm=1001.2101.3001.7020">虚拟机</a>运行的技术。<br>程序运行通常有两种方式，一种是静态编译，一种是动态解释，即时编译混合了这二者。</p><p>lujit运行过程：</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281240021.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281240021.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><h1 id="解题："><a href="#解题：" class="headerlink" title="解题："></a>解题：</h1><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281606508.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281606508.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>得到一个.out 文件，电脑识别成Wireshark 系列文件，拉入WinHex会发现是.LJ开头，可以推断是Luajit逆向。</p><div class="story post-story"><h2 id="先编译LuaJit2-1-0Beta3"><a href="#先编译LuaJit2-1-0Beta3" class="headerlink" title="先编译LuaJit2.1.0Beta3"></a>先编译LuaJit2.1.0Beta3</h2><p><a href="http://luajit.org/download.html">Download (luajit.org)</a></p><p>去官网下载<img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281625246.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281625246.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>运行x64 Native Tools Command Prompt for VS （用Everything搜索），</p><p>然后将下载的安装包解压到相应的盘下，然后进入解压后的SRC文件</p><ul><li><p>msvcbuild.bat gc64编译出的64位（题目的64位</p></li><li><p>msvcbuild.bat编译出的是32位</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281629087.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281629087.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p></div><div class="story post-story"><h2 id="反编译"><a href="#反编译" class="headerlink" title="反编译"></a>反编译</h2><p><a href="https://github.com/bobsayshilol/luajit-decomp/tree/deprecated">bobsayshilol&#x2F;luajit-decomp at deprecated (github.com)</a></p><p>下载反编译工具</p><p>然后将上一步src文件夹里面jit文件夹，和lua51.dll luajit.exe 放到刚刚下载的反编译工具文件夹里面</p><p>然后将我们的题目附件改名为test.lua，再按下decoder_new.exe该文件就出现了out.lua和out2.lua</p><p>用sublime打开，就可以开始分析字节码了</p><p><img src="C:\Users\25858\AppData\Roaming\Typora\typora-user-images\image-20220528164002909.png" class="lazyload" data-srcset="C:\Users\25858\AppData\Roaming\Typora\typora-user-images\image-20220528164002909.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20220528164002909"></p><p>未完待续。。</p></div>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> -luajit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TWIN</title>
      <link href="/2022/05/28/TWIN/"/>
      <url>/2022/05/28/TWIN/</url>
      
        <content type="html"><![CDATA[<h1 id="TLS回调函数："><a href="#TLS回调函数：" class="headerlink" title="TLS回调函数："></a>TLS回调函数：</h1><p>TLS(Thread Local Storage, 线程局部存储)回调函数，TLS 回调函数的调用运行要先于 EP 代码的执行，并且每次创建或结束线程都会再次调用，故常用于反调试。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281814964.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281814964.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>可以在节区表发现IMAGE_TLS_DIRECTORY，找到Address of Callbacks（<strong>注意回调函数一般不止一个</strong>）</p><h1 id="题解："><a href="#题解：" class="headerlink" title="题解："></a>题解：</h1><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282217346.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282217346.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>32位无壳</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281835117.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281835117.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>首先是一个虚假的逻辑验证。</p><p>在函数栏搜索找到callback函数，但是$+5,没有直接反编译，找到主要回调函数</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282020289.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282020289.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>这里有一个小花指令，最好retn会跳到sub_4019BF,后面还会有一处</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __usercall <span class="title">sub_4019BF</span><span class="params">(<span class="type">int</span> a1@&lt;ebp&gt;)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">void</span> *v1; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( *(_DWORD *)(a1 + <span class="number">12</span>) == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>((<span class="type">void</span> *)(a1 - <span class="number">284</span>), <span class="number">0</span>, <span class="number">0x50</span>u);</span><br><span class="line">    <span class="built_in">sub_401930</span>((<span class="type">void</span> *)(a1 - <span class="number">284</span>));</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">1</span>) = <span class="number">0</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">1</span>) = <span class="built_in">NtCurrentPeb</span>()-&gt;BeingDebugged;</span><br><span class="line">    <span class="keyword">if</span> ( !*(_BYTE *)(a1 - <span class="number">1</span>) )</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">32</span>) = <span class="number">57</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">31</span>) = <span class="number">51</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">30</span>) = <span class="number">62</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">29</span>) = <span class="number">56</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">28</span>) = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">sub_4018C0</span>(a1 - <span class="number">32</span>);</span><br><span class="line">    hObject = <span class="built_in">CreateFileMappingA</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">4u</span>, <span class="number">0</span>, <span class="number">0x1000</span>u, (LPCSTR)(a1 - <span class="number">32</span>));</span><br><span class="line">    *(_DWORD *)dword_404448 = <span class="built_in">MapViewOfFile</span>(hObject, <span class="number">0xF001F</span>u, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0x1000</span>u);</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">116</span>) = <span class="number">47</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">115</span>) = <span class="number">19</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">114</span>) = <span class="number">26</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">113</span>) = <span class="number">30</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">112</span>) = <span class="number">12</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">111</span>) = <span class="number">26</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">110</span>) = <span class="number">95</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">109</span>) = <span class="number">22</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">108</span>) = <span class="number">17</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">107</span>) = <span class="number">15</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">106</span>) = <span class="number">10</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">105</span>) = <span class="number">11</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">104</span>) = <span class="number">95</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">103</span>) = <span class="number">6</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">102</span>) = <span class="number">16</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">101</span>) = <span class="number">10</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">100</span>) = <span class="number">13</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">99</span>) = <span class="number">95</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">98</span>) = <span class="number">25</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">97</span>) = <span class="number">19</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">96</span>) = <span class="number">30</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">95</span>) = <span class="number">24</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">94</span>) = <span class="number">69</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">93</span>) = <span class="number">95</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">92</span>) = <span class="number">0</span>;</span><br><span class="line">    v1 = (<span class="type">void</span> *)<span class="built_in">sub_4018C0</span>(a1 - <span class="number">116</span>);</span><br><span class="line">    <span class="built_in">sub_401930</span>(v1);</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">8</span>) = <span class="number">90</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">7</span>) = <span class="number">12</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">6</span>) = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">sub_4018C0</span>(a1 - <span class="number">8</span>);</span><br><span class="line">    <span class="built_in">sub_401130</span>((<span class="type">char</span> *)(a1 - <span class="number">8</span>), dword_404448[<span class="number">0</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !*(_DWORD *)(a1 + <span class="number">12</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">24</span>) = <span class="number">81</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">23</span>) = <span class="number">80</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">22</span>) = <span class="number">11</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">21</span>) = <span class="number">18</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">20</span>) = <span class="number">15</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">19</span>) = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">sub_4018C0</span>(a1 - <span class="number">24</span>);</span><br><span class="line">    <span class="built_in">sub_401410</span>();</span><br><span class="line">    <span class="built_in">memset</span>((<span class="type">void</span> *)(a1 - <span class="number">204</span>), <span class="number">0</span>, <span class="number">0x44</span>u);</span><br><span class="line">    *(_DWORD *)(a1 - <span class="number">204</span>) = <span class="number">68</span>;</span><br><span class="line">    <span class="built_in">CreateProcessA</span>(</span><br><span class="line">      (LPCSTR)(a1 - <span class="number">24</span>),</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">3u</span>,</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      (LPSTARTUPINFOA)(a1 - <span class="number">204</span>),</span><br><span class="line">      (LPPROCESS_INFORMATION)(a1 - <span class="number">136</span>));</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">44</span>) = <span class="number">28</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">43</span>) = <span class="number">16</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">42</span>) = <span class="number">13</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">41</span>) = <span class="number">13</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">40</span>) = <span class="number">26</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">39</span>) = <span class="number">28</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">38</span>) = <span class="number">11</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">37</span>) = <span class="number">117</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">36</span>) = <span class="number">0</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">16</span>) = <span class="number">8</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">15</span>) = <span class="number">13</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">14</span>) = <span class="number">16</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">13</span>) = <span class="number">17</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">12</span>) = <span class="number">24</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">11</span>) = <span class="number">117</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">10</span>) = <span class="number">0</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">88</span>) = <span class="number">47</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">87</span>) = <span class="number">19</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">86</span>) = <span class="number">26</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">85</span>) = <span class="number">30</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">84</span>) = <span class="number">12</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">83</span>) = <span class="number">26</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">82</span>) = <span class="number">95</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">81</span>) = <span class="number">28</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">80</span>) = <span class="number">19</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">79</span>) = <span class="number">16</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">78</span>) = <span class="number">12</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">77</span>) = <span class="number">26</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">76</span>) = <span class="number">95</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">75</span>) = <span class="number">11</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">74</span>) = <span class="number">23</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">73</span>) = <span class="number">26</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">72</span>) = <span class="number">95</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">71</span>) = <span class="number">27</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">70</span>) = <span class="number">26</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">69</span>) = <span class="number">29</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">68</span>) = <span class="number">10</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">67</span>) = <span class="number">24</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">66</span>) = <span class="number">24</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">65</span>) = <span class="number">26</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">64</span>) = <span class="number">13</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">63</span>) = <span class="number">95</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">62</span>) = <span class="number">30</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">61</span>) = <span class="number">17</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">60</span>) = <span class="number">27</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">59</span>) = <span class="number">95</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">58</span>) = <span class="number">11</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">57</span>) = <span class="number">13</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">56</span>) = <span class="number">6</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">55</span>) = <span class="number">95</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">54</span>) = <span class="number">30</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">53</span>) = <span class="number">24</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">52</span>) = <span class="number">30</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">51</span>) = <span class="number">22</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">50</span>) = <span class="number">17</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">49</span>) = <span class="number">117</span>;</span><br><span class="line">    *(_BYTE *)(a1 - <span class="number">48</span>) = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">sub_401510</span>(a1 - <span class="number">24</span>, a1 - <span class="number">136</span>);</span><br><span class="line">    <span class="keyword">if</span> ( dword_404440 == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">sub_4012C0</span>(*(_DWORD *)dword_404448 + <span class="number">20</span>, <span class="number">5</span>, &amp;unk_40405C);</span><br><span class="line">      *(_DWORD *)(a1 - <span class="number">120</span>) = <span class="built_in">memcmp</span>((<span class="type">const</span> <span class="type">void</span> *)(*(_DWORD *)dword_404448 + <span class="number">20</span>), &amp;unk_40402C, <span class="number">0x14</span>u);</span><br><span class="line">      <span class="keyword">if</span> ( !*(_DWORD *)(a1 - <span class="number">120</span>) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">sub_4018C0</span>(a1 - <span class="number">44</span>);</span><br><span class="line">        <span class="built_in">sub_401930</span>((<span class="type">void</span> *)(a1 - <span class="number">44</span>));</span><br><span class="line">LABEL_12:</span><br><span class="line">        <span class="built_in">CloseHandle</span>(hObject);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( dword_404440 == <span class="number">-2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">sub_4018C0</span>(a1 - <span class="number">88</span>);</span><br><span class="line">      <span class="built_in">sub_401930</span>((<span class="type">void</span> *)(a1 - <span class="number">88</span>));</span><br><span class="line">      <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sub_4018C0</span>(a1 - <span class="number">16</span>);</span><br><span class="line">    <span class="built_in">sub_401930</span>((<span class="type">void</span> *)(a1 - <span class="number">16</span>));</span><br><span class="line">    <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个函数有两大部分</p><ul><li>这个a1 + 12就是对应着运行前与退出，对应DLL_PROCESS_ATTACH和DLL_PROCESS_DETACH</li><li>所以总结一下！a1 + 12 &#x3D;&#x3D; 1是线程运行之前执行</li><li>a1 + 12 &#x3D;&#x3D; 0 是线程退出后运行</li></ul><p>首先会遇到一个PEB反调试，我们直接修改ZF标志位绕过。</p><p>然后就是一个异或，将原始数据inputflag混肴。</p><p>紧接着读取我们的输入，</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282021090.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282021090.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>输入之后F9进入第二部分</p><ul><li>获取WriteFile API的地址</li><li>将WriteFile API地址改成自写函数的地址（也就是Hook函数）</li><li>也就是之后我们调用WriteFile函数地址就会调用Hook函数（Hook函数里执行完Hook代码就会脱钩）</li></ul><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282046086.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282046086.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>GetModuleHandleA得到WiteFile函数的句柄，GetProcAddress函数获取WriteFile函数的地址存入dword_4043DC，并在sub_4016C0中将这个值修改为sub_401650的地址值。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282048757.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282048757.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>随后在第二个TLS函数会调用ExitProcess()，也就是退出进程，那么退出进程又会调用TLS函数链，于是又回到了第一个TLS函数，不过这次进的是退出线程的函数块，分析主要函数</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281926308.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205281926308.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>这里创建了一个文件，也就是tmp文件，但是对名字也进行了混肴,然后往里面写入进程。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282139101.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282139101.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>我们可以发现这里的writefile变成了我们相要执行的函数</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282143122.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282143122.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>把子进程的两个值改成6，实践上是xxtea在加密过程中的右移轮次。</p><p>接下来分析一下tmp文件。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282152680.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282152680.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>其中</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282155309.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282155309.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>先判断是否被调试，然后对delta进行异或操作。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282153182.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282153182.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p><code>hObject = CreateFileMappingA(0, 0, 4u, 0, 0x1000u, Name_FLAG);</code>创建名字为FLAG的文件映射对象，用于进程间通信。<br><code>*(_DWORD *)input = MapViewOfFile(hObject, 0xF001Fu, 0, 0, 0x1000u);</code>存了内存映射文件，便于后面的共享内存。<br>简而言之，就是创建一个名为FLAG的文件映射对象，把input指向的地址设置成一块共享的内存，这样就可以在子进程里对input这块内存进行修改，实现加密。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282154172.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282154172.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>一个魔改的XXTEA加密，z右移5改成了右移6位</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282201294.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282201294.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>这里一处函数需要注意</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282204815.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205282204815.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>WaitForDebugEvent表明父进程调用子进程是以调试方式打开，也就是说父进程调试子进程，所以实际上子进程的反调试是不能绕过的，正常执行程序应该会进入子进程的if语句，对key和delta进行一些魔改运算。<br>0xC0000005，这是一个异常代码，代表<code>EXCEPTION_ACCESS_VIOLATION</code>，内存访问异常，也即子进程中触发的异常。</p><p>也就是说，子进程被父进程调试，当子进程发生异常，应当交由调试者（父进程）处理。所以当子进程中触发异常，程序就会流回父进程，判断是否为内存访问异常，如果是，就对eip和eax做出相应修改。</p><p>再回去看子进程触发异常的地方，eip+5之后正好跳过了会触发异常的地方。而eax里存储的实际上是delta经过一通魔改运算之后的结果。也就是说，delta不仅在子进程里被修改，还会在父进程里异或一次，也就是还原成之前最初的模样</p><p>前一半的（修改的</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x1c925d64</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z&gt;&gt;6^y<span class="string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> k[<span class="number">4</span>]= &#123;<span class="number">0x12</span>,<span class="number">0x90</span>,<span class="number">0x56</span>,<span class="number">0x78</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">xxtea</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n, <span class="type">uint32_t</span>* key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> sum,z,p,y;</span><br><span class="line">    <span class="type">int</span> e, rounds;</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">    sum = rounds * DELTA;</span><br><span class="line">    y = v[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">        &#123;</span><br><span class="line">            z = v[p<span class="number">-1</span>];</span><br><span class="line">            y = v[p] -= MX;</span><br><span class="line">        &#125;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">        sum -= DELTA;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">5</span>] = &#123;<span class="number">0x6b7ce328</span>,<span class="number">0x4841d5dd</span>,<span class="number">0x963784dc</span>,<span class="number">0xef8a3226</span>,<span class="number">0x776b226</span>&#125;;</span><br><span class="line">    <span class="type">int</span> n = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">xxtea</span>(v, n, k);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,v[i]&amp;<span class="number">0xff</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,v[i]&gt;&gt;<span class="number">8</span>&amp;<span class="number">0xff</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,v[i]&gt;&gt;<span class="number">16</span>&amp;<span class="number">0xff</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,v[i]&gt;&gt;<span class="number">24</span>&amp;<span class="number">0xff</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>后面那半就比较好出了，没有改任何Delta数或XXTEA算法</p><p>miniLctf{cbda59ff59e3e90c91c02e9b40b78b}</p><p>参考：<a href="http://www.yunzh1jun.com/2022/05/27/miniL/#Tip5%EF%BC%9Ahook">miniL2022 WP 今晚恰烤lq！ - 云之君 (yunzh1jun.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TLS回调函数 </tag>
            
            <tag> 反调试 </tag>
            
            <tag> 异常处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CEF</title>
      <link href="/2022/05/27/cef/"/>
      <url>/2022/05/27/cef/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205272105336.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205272105336.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>32位无壳程序</p><h1 id="CEF简介"><a href="#CEF简介" class="headerlink" title="CEF简介:"></a>CEF简介:</h1><p>  嵌入式Chromium框架(简称CEF) 是一个由Marshall Greenblatt在2008建立的开源项目，它主要目的是开发一个基于Google Chromium的Webbrowser控件。CEF支持一系列的编程语言和操作系统，并且能很容易地整合到新的或已有的工程中去。</p><h1 id="解题："><a href="#解题：" class="headerlink" title="解题："></a>解题：</h1><p>正面去分析的话，十分困难。去搜索相应字符串无果</p><p>这里我们可以去从数据调用去分析，我们去分析.data的数据</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205272116979.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205272116979.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>一组奇怪的数据，猜测加密时用到，交叉引用找到调用的地方</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205272122503.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205272122503.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>调试验证一下，一开始会停在调用的dll函数里面，我们直接步过，然后输入32位之后就会断下F9提示correct，验证我们的猜想是正确的。调试发现其实，加密整个逻辑就在else里面，一个魔改的SM4，其基本运算为异或^和循环左移&lt;&lt;&lt;</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205272231669.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205272231669.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>round函数</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205272222856.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205272222856.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>解密：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> SK[<span class="number">32</span>] = &#123;</span><br><span class="line">    <span class="number">0xE8DB227C</span>, <span class="number">0x012451B9</span>, <span class="number">0xED08A9DB</span>, <span class="number">0xC91F65C3</span>,</span><br><span class="line">         <span class="number">0xB3D1E981</span>, <span class="number">0x319B4734</span>, <span class="number">0xA4BA5551</span>, <span class="number">0xD0F2ED2D</span>,</span><br><span class="line">         <span class="number">0x4A00D692</span>, <span class="number">0xE0AEFE30</span>, <span class="number">0x6BBCDB4A</span>, <span class="number">0xC315F6F1</span>,</span><br><span class="line">         <span class="number">0xB4E1B030</span>, <span class="number">0x694C4ACE</span>, <span class="number">0x479208D3</span>, <span class="number">0x3F8C7B97</span>,</span><br><span class="line">         <span class="number">0x747777A6</span>, <span class="number">0xEDEC9BBB</span>, <span class="number">0xC8E506C1</span>, <span class="number">0xB955A92A</span>,</span><br><span class="line">         <span class="number">0xB388FDBB</span>, <span class="number">0x1A4697C3</span>, <span class="number">0xB10826AA</span>, <span class="number">0xBB1F2207</span>,</span><br><span class="line">         <span class="number">0x291DCD60</span>, <span class="number">0x2BA3E3A7</span>, <span class="number">0x1B83DFDD</span>, <span class="number">0x014D4FD5</span>,</span><br><span class="line">         <span class="number">0x80C659F3</span>, <span class="number">0x3EB45B23</span>, <span class="number">0x43E36266</span>, <span class="number">0xBD22532C</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GET_ULONG(n, b, i)\</span></span><br><span class="line"><span class="meta">(n) = ( (unsigned long) (b)[(i + 3)] &lt;&lt; 24 )\</span></span><br><span class="line"><span class="meta">| ( (unsigned long) (b)[(i + 2)] &lt;&lt; 16 )\</span></span><br><span class="line"><span class="meta">| ( (unsigned long) (b)[(i + 1)] &lt;&lt; 8  )\</span></span><br><span class="line"><span class="meta">| ( (unsigned long) (b)[(i    )]    ); \</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PUT_ULONG(n, b, i)\</span></span><br><span class="line"><span class="meta">&#123;\</span></span><br><span class="line"><span class="meta">(b)[(i) + 3] = (unsigned char) ( (n) &gt;&gt; 24 );\</span></span><br><span class="line"><span class="meta">(b)[(i) + 2] = (unsigned char) ( (n) &gt;&gt; 16 );\</span></span><br><span class="line"><span class="meta">(b)[(i) + 1] = (unsigned char) ( (n) &gt;&gt; 8  );\</span></span><br><span class="line"><span class="meta">(b)[(i)    ] = (unsigned char) ( (n)   );\</span></span><br><span class="line"><span class="meta">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SHL(x, n) ( ((x) &amp; 0xFFFFFFFF) &lt;&lt; n )</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ROTL(x, n) ( SHL((x), n) | ((x) &gt;&gt; (32 - n)) )</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SWAP(a, b) &#123; unsigned t = a; a = b; b = t; t = 0; &#125; </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SM4_Decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> * input, <span class="type">unsigned</span> <span class="type">char</span> * output, <span class="type">int</span> len)</span></span>; </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Round</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> input[<span class="number">16</span>], <span class="type">unsigned</span> <span class="type">char</span> output[<span class="number">16</span>])</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> input[] = </span><br><span class="line">&#123;</span><br><span class="line"> <span class="number">0x7D</span>, <span class="number">0x54</span>, <span class="number">0xCB</span>, <span class="number">0xC0</span>, <span class="number">0x74</span>, <span class="number">0xDB</span>, <span class="number">0xF5</span>, <span class="number">0xD7</span>, <span class="number">0x6F</span>, <span class="number">0xD9</span>,</span><br><span class="line">    <span class="number">0x92</span>, <span class="number">0x1B</span>, <span class="number">0xEB</span>, <span class="number">0x28</span>, <span class="number">0x46</span>, <span class="number">0x20</span>, <span class="number">0xE5</span>, <span class="number">0xD5</span>, <span class="number">0xD3</span>, <span class="number">0x60</span>,</span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x6D</span>, <span class="number">0x36</span>, <span class="number">0x2F</span>, <span class="number">0xB0</span>, <span class="number">0x63</span>, <span class="number">0x2F</span>, <span class="number">0x61</span>, <span class="number">0x20</span>, <span class="number">0x0F</span>,</span><br><span class="line">    <span class="number">0xA9</span>, <span class="number">0x30</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> output[<span class="number">32</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"></span><br><span class="line"><span class="built_in">SM4_Decrypt</span>(input, output, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++ )</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//printf(&quot;0x%X, &quot;, output[i]);</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, output[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SM4_Decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> * input, <span class="type">unsigned</span> <span class="type">char</span> * output, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++ )</span><br><span class="line"><span class="built_in">SWAP</span>(SK[i], SK[<span class="number">31</span> - i]);</span><br><span class="line"><span class="keyword">while</span> ( len &gt; <span class="number">0</span> )</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Round</span>(input, output);</span><br><span class="line"></span><br><span class="line">input += <span class="number">16</span>;</span><br><span class="line">output += <span class="number">16</span>;</span><br><span class="line">len -= <span class="number">16</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Round</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> input[<span class="number">16</span>], <span class="type">unsigned</span> <span class="type">char</span> output[<span class="number">16</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> tmp[<span class="number">4</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">GET_ULONG</span>(tmp[<span class="number">0</span>], input, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">GET_ULONG</span>(tmp[<span class="number">1</span>], input, <span class="number">4</span>);</span><br><span class="line"><span class="built_in">GET_ULONG</span>(tmp[<span class="number">2</span>], input, <span class="number">8</span>);</span><br><span class="line"><span class="built_in">GET_ULONG</span>(tmp[<span class="number">3</span>], input, <span class="number">12</span>);</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++ )</span><br><span class="line">&#123;</span><br><span class="line">t = SK[i] ^ tmp[(i + <span class="number">1</span>) % <span class="number">4</span>] ^ tmp[(i + <span class="number">2</span>) % <span class="number">4</span>] ^ tmp[(i + <span class="number">3</span>) % <span class="number">4</span>];</span><br><span class="line">tmp[i % <span class="number">4</span>] ^= t ^ <span class="built_in">ROTL</span>(t, <span class="number">2</span>) ^ <span class="built_in">ROTL</span>(t, <span class="number">24</span>) ^ <span class="built_in">ROTL</span>(t, <span class="number">10</span>) ^ <span class="built_in">ROTL</span>(t, <span class="number">18</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span> ; i &lt; <span class="number">4</span>; i++ )</span><br><span class="line"><span class="built_in">GET_ULONG</span>(SK[<span class="number">26</span> - i], input, i * <span class="number">4</span>);<span class="comment">// 正好是把加密后的值放入 那么解密的时候就是把密文放入即可 </span></span><br><span class="line"><span class="built_in">PUT_ULONG</span>(tmp[<span class="number">3</span>], output, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">PUT_ULONG</span>(tmp[<span class="number">2</span>], output, <span class="number">4</span>);</span><br><span class="line"><span class="built_in">PUT_ULONG</span>(tmp[<span class="number">1</span>], output, <span class="number">8</span>);</span><br><span class="line"><span class="built_in">PUT_ULONG</span>(tmp[<span class="number">0</span>], output, <span class="number">12</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行得到 3b2365b04700b5eac3a5fd0ba21b687f</p><p>参考：<a href="https://ppppz.net/2022/05/26/DASCTF2022-X-VOID-CEF/">DASCTF2022 X VOID-CEF - P.Z’s Blog (ppppz.net)</a></p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> -CEF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WER</title>
      <link href="/2022/05/26/WER/"/>
      <url>/2022/05/26/WER/</url>
      
        <content type="html"><![CDATA[<p>无壳，64位</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205262127014.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205262127014.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><div class="story post-story"><h2 id="什么是WER："><a href="#什么是WER：" class="headerlink" title="什么是WER："></a>什么是WER：</h2><p>Windows 错误报告 (WER) 是一种灵活的基于事件的反馈基础结构，旨在收集有关Windows可以检测、向 Microsoft 报告信息以及为用户提供任何可用解决方案的硬件和软件问题的相关信息。</p><p>参考：<a href="https://docs.microsoft.com/zh-cn/windows/win32/wer/about-wer">关于 WER - Win32 apps | Microsoft Docs</a></p><p>其关键函数如下：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DWORD WINAPI <span class="title">ApplicationRecoveryCallback</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">   PVOID pvParameter <span class="comment">//上下文信息在调用‎‎注册应用程序恢复回拨‎‎函数以注册恢复时指定。‎</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br></pre></td></tr></table></figure><p>‎应用程序定义的回调函数，用于在应用程序遇到未处理的异常或无响应时保存数据和应用程序状态信息。</p><p>参考：<a href="https://docs.microsoft.com/en-us/previous-versions/windows/desktop/legacy/aa373202(v=vs.85)">ApplicationRecoveryCallback callback function (Windows) | Microsoft Docs</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HRESULT <span class="title">WerReportHang</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]           HWND   hwndHungApp, <span class="comment">//‎处理未响应的窗口。</span></span></span></span><br><span class="line"><span class="params"><span class="function">  [in, optional] PCWSTR pwzHungApplicationName <span class="comment">//要在挂起的报告 UI 中显示的无响应应用程序的名称。</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br></pre></td></tr></table></figure><p>返回值‎：‎返回S_OK函数是否能够在失败时启动报告或错误代码。请注意，S_OK并不一定意味着“无响应”报告已成功完成，而只是表示已启动。‎</p><p>参考：<a href="https://docs.microsoft.com/en-us/windows/win32/api/errorrep/nf-errorrep-werreporthang">WerReportHang function (errorrep.h) - Win32 apps | Microsoft Docs</a></p><p>主要运行逻辑为：</p><p>1.在初始化注册ApplicationRecoveryCallback函数</p><p>2.在OnExit调用WerReportHang触发异常</p><p>3.运用ApplicationRecoveryCallback进行真正的逻辑处理。</p><p>本题OnExit函数就在main函数里面，调用WerReportHang就会关闭调试器，调试不起来</p></div><div class="story post-story"><h2 id="解题："><a href="#解题：" class="headerlink" title="解题："></a>解题：</h2><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205262200156.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205262200156.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>搜索关键函数，在import表里面找到，放在了一个dll里面</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205262210102.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205262210102.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>然后交叉引用找到：</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205262210460.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205262210460.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>这里的sub_14000F3B0就是我们要找的关键函数</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205262210850.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205262210850.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>也可以通过MessageBox函数来找。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data = [  <span class="number">0x05</span>, <span class="number">0x03</span>, <span class="number">0x55</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0x07</span>, <span class="number">0x5E</span>, <span class="number">0x54</span>, <span class="number">0x05</span>, <span class="number">0x07</span>, <span class="number">0x50</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x53</span>, <span class="number">0x5F</span>, <span class="number">0x50</span>, <span class="number">0x53</span>, <span class="number">0x50</span>, <span class="number">0x53</span>, <span class="number">0x05</span>, <span class="number">0x55</span>, <span class="number">0x00</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x57</span>, <span class="number">0x03</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x52</span>, <span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0x53</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(data[i] ^ <span class="number">102</span>), end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p>异或写脚本得到flag</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205262214536.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205262214536.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p></div>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> -[wer] </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>末日邀请</title>
      <link href="/2022/05/24/KCTF-%E6%9C%AB%E6%97%A5%E9%82%80%E8%AF%B7%EF%BC%88%E5%8A%A0%E5%AF%86%E9%97%AF%E5%85%B3%EF%BC%89/"/>
      <url>/2022/05/24/KCTF-%E6%9C%AB%E6%97%A5%E9%82%80%E8%AF%B7%EF%BC%88%E5%8A%A0%E5%AF%86%E9%97%AF%E5%85%B3%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>先是输入flag也就是ID，然后进行check，主要考察算法。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205151944388.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205151944388.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>对我们的输入进行一系列异或，最后赋值给v39，注意这里v39类型是char，接着进行sbox数据初始化，</p><p>然后进行CRC32验证，这里可以动调取到flag，这里v34的值后面会给出并进行验证。</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205151954909.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205151954909.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>接着先将字符转成数值，存入内存，并且如果大于58就减去55.接着用冰雹猜想验证输入的前三位。我们可以爆破得到v17的值是定值7.具体前三位先按下不表</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152014418.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152014418.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>爆破代码：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> i; <span class="comment">// edx</span></span><br><span class="line"><span class="type">int</span> v13; <span class="comment">// ecx</span></span><br><span class="line"><span class="type">int</span> v15; <span class="comment">// eax</span></span><br><span class="line"><span class="type">int</span> j; <span class="comment">// edx</span></span><br><span class="line"><span class="type">int</span> v17; <span class="comment">// edi</span></span><br><span class="line"><span class="type">int</span> v33[<span class="number">200</span>]; <span class="comment">// [esp+10h] [ebp-368h]</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">0xff</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v13 = i;</span><br><span class="line">        v15 = v13;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt; <span class="number">200</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((v15 &amp; <span class="number">1</span>) != <span class="number">0</span>)                     <span class="comment">// 奇数*3+1</span></span><br><span class="line">                v15 = <span class="number">3</span> * v15 + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                v15 &gt;&gt;= <span class="number">1</span>;                              <span class="comment">// 偶数右移1</span></span><br><span class="line">            v33[j] = v15;</span><br><span class="line">        &#125;</span><br><span class="line">        v17 = v33[<span class="number">198</span>] | v33[<span class="number">197</span>] | v33[<span class="number">196</span>];</span><br><span class="line">        cout &lt;&lt; v17 &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>后面就是判断后四位是否为KCTF</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152022192.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152022192.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>动调发现是v41[1]是输入的第8个字符，推测后面还需要验证九位，然后进行取余验证，依次取最高前i位，看是否能取余i，不能则失败。但是后面对这里有一个约束。先是冒泡排序从小到大排序，然后对比1<del>9，也就是必须包含1</del>9每个数字</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152025132.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152025132.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152036244.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152036244.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>爆破取得这九位：381654729</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000000</span>,<span class="number">1000000000</span>):</span><br><span class="line">    <span class="keyword">if</span> i//<span class="number">10000000</span> %<span class="number">2</span> == <span class="number">0</span> <span class="keyword">and</span> i//<span class="number">1000000</span>%<span class="number">3</span> == <span class="number">0</span> <span class="keyword">and</span> i//<span class="number">100000</span>%<span class="number">4</span> == <span class="number">0</span> <span class="keyword">and</span> i//<span class="number">10000</span>%<span class="number">5</span> == <span class="number">0</span> <span class="keyword">and</span> i//<span class="number">1000</span> %<span class="number">6</span> == <span class="number">0</span> <span class="keyword">and</span> i//<span class="number">100</span> % <span class="number">7</span> == <span class="number">0</span> <span class="keyword">and</span> i//<span class="number">10</span> % <span class="number">8</span> == <span class="number">0</span> <span class="keyword">and</span> i%<span class="number">9</span> == <span class="number">0</span>:</span><br><span class="line">        num_all = <span class="built_in">str</span>(i)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;1&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;2&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;3&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;4&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;5&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;6&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;7&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;8&quot;</span> <span class="keyword">in</span> num_all <span class="keyword">and</span> <span class="string">&quot;9&quot;</span> <span class="keyword">in</span> num_all :</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><p>最后就是判断v34是否相等 也就是前三位</p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152049128.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205152049128.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p>爆破得到前三位：421</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">uint32_t</span> magic_arr[] = &#123;<span class="number">0x00000000</span>, <span class="number">0x09073096</span>, <span class="number">0x120E612C</span>, <span class="number">0x1B0951BA</span>, <span class="number">0xFF6DC419</span>, <span class="number">0xF66AF48F</span>, <span class="number">0xED63A535</span>, <span class="number">0xE46495A3</span>,</span><br><span class="line">                        <span class="number">0xFEDB8832</span>, <span class="number">0xF7DCB8A4</span>, <span class="number">0xECD5E91E</span>, <span class="number">0xE5D2D988</span>, <span class="number">0x01B64C2B</span>, <span class="number">0x08B17CBD</span>, <span class="number">0x13B82D07</span>, <span class="number">0x1ABF1D91</span>,</span><br><span class="line">                        <span class="number">0xFDB71064</span>, <span class="number">0xF4B020F2</span>, <span class="number">0xEFB97148</span>, <span class="number">0xE6BE41DE</span>, <span class="number">0x02DAD47D</span>, <span class="number">0x0BDDE4EB</span>, <span class="number">0x10D4B551</span>, <span class="number">0x19D385C7</span>,</span><br><span class="line">                        <span class="number">0x036C9856</span>, <span class="number">0x0A6BA8C0</span>, <span class="number">0x1162F97A</span>, <span class="number">0x1865C9EC</span>, <span class="number">0xFC015C4F</span>, <span class="number">0xF5066CD9</span>, <span class="number">0xEE0F3D63</span>, <span class="number">0xE7080DF5</span>,</span><br><span class="line">                        <span class="number">0xFB6E20C8</span>, <span class="number">0xF269105E</span>, <span class="number">0xE96041E4</span>, <span class="number">0xE0677172</span>, <span class="number">0x0403E4D1</span>, <span class="number">0x0D04D447</span>, <span class="number">0x160D85FD</span>, <span class="number">0x1F0AB56B</span>,</span><br><span class="line">                        <span class="number">0x05B5A8FA</span>, <span class="number">0x0CB2986C</span>, <span class="number">0x17BBC9D6</span>, <span class="number">0x1EBCF940</span>, <span class="number">0xFAD86CE3</span>, <span class="number">0xF3DF5C75</span>, <span class="number">0xE8D60DCF</span>, <span class="number">0xE1D13D59</span>,</span><br><span class="line">                        <span class="number">0x06D930AC</span>, <span class="number">0x0FDE003A</span>, <span class="number">0x14D75180</span>, <span class="number">0x1DD06116</span>, <span class="number">0xF9B4F4B5</span>, <span class="number">0xF0B3C423</span>, <span class="number">0xEBBA9599</span>, <span class="number">0xE2BDA50F</span>,</span><br><span class="line">                        <span class="number">0xF802B89E</span>, <span class="number">0xF1058808</span>, <span class="number">0xEA0CD9B2</span>, <span class="number">0xE30BE924</span>, <span class="number">0x076F7C87</span>, <span class="number">0x0E684C11</span>, <span class="number">0x15611DAB</span>, <span class="number">0x1C662D3D</span>,</span><br><span class="line">                        <span class="number">0xF6DC4190</span>, <span class="number">0xFFDB7106</span>, <span class="number">0xE4D220BC</span>, <span class="number">0xEDD5102A</span>, <span class="number">0x09B18589</span>, <span class="number">0x00B6B51F</span>, <span class="number">0x1BBFE4A5</span>, <span class="number">0x12B8D433</span>,</span><br><span class="line">                        <span class="number">0x0807C9A2</span>, <span class="number">0x0100F934</span>, <span class="number">0x1A09A88E</span>, <span class="number">0x130E9818</span>, <span class="number">0xF76A0DBB</span>, <span class="number">0xFE6D3D2D</span>, <span class="number">0xE5646C97</span>, <span class="number">0xEC635C01</span>,</span><br><span class="line">                        <span class="number">0x0B6B51F4</span>, <span class="number">0x026C6162</span>, <span class="number">0x196530D8</span>, <span class="number">0x1062004E</span>, <span class="number">0xF40695ED</span>, <span class="number">0xFD01A57B</span>, <span class="number">0xE608F4C1</span>, <span class="number">0xEF0FC457</span>,</span><br><span class="line">                        <span class="number">0xF5B0D9C6</span>, <span class="number">0xFCB7E950</span>, <span class="number">0xE7BEB8EA</span>, <span class="number">0xEEB9887C</span>, <span class="number">0x0ADD1DDF</span>, <span class="number">0x03DA2D49</span>, <span class="number">0x18D37CF3</span>, <span class="number">0x11D44C65</span>,</span><br><span class="line">                        <span class="number">0x0DB26158</span>, <span class="number">0x04B551CE</span>, <span class="number">0x1FBC0074</span>, <span class="number">0x16BB30E2</span>, <span class="number">0xF2DFA541</span>, <span class="number">0xFBD895D7</span>, <span class="number">0xE0D1C46D</span>, <span class="number">0xE9D6F4FB</span>,</span><br><span class="line">                        <span class="number">0xF369E96A</span>, <span class="number">0xFA6ED9FC</span>, <span class="number">0xE1678846</span>, <span class="number">0xE860B8D0</span>, <span class="number">0x0C042D73</span>, <span class="number">0x05031DE5</span>, <span class="number">0x1E0A4C5F</span>, <span class="number">0x170D7CC9</span>,</span><br><span class="line">                        <span class="number">0xF005713C</span>, <span class="number">0xF90241AA</span>, <span class="number">0xE20B1010</span>, <span class="number">0xEB0C2086</span>, <span class="number">0x0F68B525</span>, <span class="number">0x066F85B3</span>, <span class="number">0x1D66D409</span>, <span class="number">0x1461E49F</span>,</span><br><span class="line">                        <span class="number">0x0EDEF90E</span>, <span class="number">0x07D9C998</span>, <span class="number">0x1CD09822</span>, <span class="number">0x15D7A8B4</span>, <span class="number">0xF1B33D17</span>, <span class="number">0xF8B40D81</span>, <span class="number">0xE3BD5C3B</span>, <span class="number">0xEABA6CAD</span>,</span><br><span class="line">                        <span class="number">0xEDB88320</span>, <span class="number">0xE4BFB3B6</span>, <span class="number">0xFFB6E20C</span>, <span class="number">0xF6B1D29A</span>, <span class="number">0x12D54739</span>, <span class="number">0x1BD277AF</span>, <span class="number">0x00DB2615</span>, <span class="number">0x09DC1683</span>,</span><br><span class="line">                        <span class="number">0x13630B12</span>, <span class="number">0x1A643B84</span>, <span class="number">0x016D6A3E</span>, <span class="number">0x086A5AA8</span>, <span class="number">0xEC0ECF0B</span>, <span class="number">0xE509FF9D</span>, <span class="number">0xFE00AE27</span>, <span class="number">0xF7079EB1</span>,</span><br><span class="line">                        <span class="number">0x100F9344</span>, <span class="number">0x1908A3D2</span>, <span class="number">0x0201F268</span>, <span class="number">0x0B06C2FE</span>, <span class="number">0xEF62575D</span>, <span class="number">0xE66567CB</span>, <span class="number">0xFD6C3671</span>, <span class="number">0xF46B06E7</span>,</span><br><span class="line">                        <span class="number">0xEED41B76</span>, <span class="number">0xE7D32BE0</span>, <span class="number">0xFCDA7A5A</span>, <span class="number">0xF5DD4ACC</span>, <span class="number">0x11B9DF6F</span>, <span class="number">0x18BEEFF9</span>, <span class="number">0x03B7BE43</span>, <span class="number">0x0AB08ED5</span>,</span><br><span class="line">                        <span class="number">0x16D6A3E8</span>, <span class="number">0x1FD1937E</span>, <span class="number">0x04D8C2C4</span>, <span class="number">0x0DDFF252</span>, <span class="number">0xE9BB67F1</span>, <span class="number">0xE0BC5767</span>, <span class="number">0xFBB506DD</span>, <span class="number">0xF2B2364B</span>,</span><br><span class="line">                        <span class="number">0xE80D2BDA</span>, <span class="number">0xE10A1B4C</span>, <span class="number">0xFA034AF6</span>, <span class="number">0xF3047A60</span>, <span class="number">0x1760EFC3</span>, <span class="number">0x1E67DF55</span>, <span class="number">0x056E8EEF</span>, <span class="number">0x0C69BE79</span>,</span><br><span class="line">                        <span class="number">0xEB61B38C</span>, <span class="number">0xE266831A</span>, <span class="number">0xF96FD2A0</span>, <span class="number">0xF068E236</span>, <span class="number">0x140C7795</span>, <span class="number">0x1D0B4703</span>, <span class="number">0x060216B9</span>, <span class="number">0x0F05262F</span>,</span><br><span class="line">                        <span class="number">0x15BA3BBE</span>, <span class="number">0x1CBD0B28</span>, <span class="number">0x07B45A92</span>, <span class="number">0x0EB36A04</span>, <span class="number">0xEAD7FFA7</span>, <span class="number">0xE3D0CF31</span>, <span class="number">0xF8D99E8B</span>, <span class="number">0xF1DEAE1D</span>,</span><br><span class="line">                        <span class="number">0x1B64C2B0</span>, <span class="number">0x1263F226</span>, <span class="number">0x096AA39C</span>, <span class="number">0x006D930A</span>, <span class="number">0xE40906A9</span>, <span class="number">0xED0E363F</span>, <span class="number">0xF6076785</span>, <span class="number">0xFF005713</span>,</span><br><span class="line">                        <span class="number">0xE5BF4A82</span>, <span class="number">0xECB87A14</span>, <span class="number">0xF7B12BAE</span>, <span class="number">0xFEB61B38</span>, <span class="number">0x1AD28E9B</span>, <span class="number">0x13D5BE0D</span>, <span class="number">0x08DCEFB7</span>, <span class="number">0x01DBDF21</span>,</span><br><span class="line">                        <span class="number">0xE6D3D2D4</span>, <span class="number">0xEFD4E242</span>, <span class="number">0xF4DDB3F8</span>, <span class="number">0xFDDA836E</span>, <span class="number">0x19BE16CD</span>, <span class="number">0x10B9265B</span>, <span class="number">0x0BB077E1</span>, <span class="number">0x02B74777</span>,</span><br><span class="line">                        <span class="number">0x18085AE6</span>, <span class="number">0x110F6A70</span>, <span class="number">0x0A063BCA</span>, <span class="number">0x03010B5C</span>, <span class="number">0xE7659EFF</span>, <span class="number">0xEE62AE69</span>, <span class="number">0xF56BFFD3</span>, <span class="number">0xFC6CCF45</span>,</span><br><span class="line">                        <span class="number">0xE00AE278</span>, <span class="number">0xE90DD2EE</span>, <span class="number">0xF2048354</span>, <span class="number">0xFB03B3C2</span>, <span class="number">0x1F672661</span>, <span class="number">0x166016F7</span>, <span class="number">0x0D69474D</span>, <span class="number">0x046E77DB</span>,</span><br><span class="line">                        <span class="number">0x1ED16A4A</span>, <span class="number">0x17D65ADC</span>, <span class="number">0x0CDF0B66</span>, <span class="number">0x05D83BF0</span>, <span class="number">0xE1BCAE53</span>, <span class="number">0xE8BB9EC5</span>, <span class="number">0xF3B2CF7F</span>, <span class="number">0xFAB5FFE9</span>,</span><br><span class="line">                        <span class="number">0x1DBDF21C</span>, <span class="number">0x14BAC28A</span>, <span class="number">0x0FB39330</span>, <span class="number">0x06B4A3A6</span>, <span class="number">0xE2D03605</span>, <span class="number">0xEBD70693</span>, <span class="number">0xF0DE5729</span>, <span class="number">0xF9D967BF</span>,</span><br><span class="line">                        <span class="number">0xE3667A2E</span>, <span class="number">0xEA614AB8</span>, <span class="number">0xF1681B02</span>, <span class="number">0xF86F2B94</span>, <span class="number">0x1C0BBE37</span>, <span class="number">0x150C8EA1</span>, <span class="number">0x0E05DF1B</span>, <span class="number">0x0702EF8D</span>&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="type">char</span> cstr[] = <span class="string">&quot;...KCTF381654729&quot;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0x20</span>; i &lt; <span class="number">0x7e</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0x20</span>; j &lt; <span class="number">0x7e</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0x20</span>; k &lt; <span class="number">0x7e</span>; k++) &#123;</span><br><span class="line">                cstr[<span class="number">0</span>] = i;</span><br><span class="line">                cstr[<span class="number">1</span>] = j;</span><br><span class="line">                cstr[<span class="number">2</span>] = k;</span><br><span class="line">                <span class="type">int32_t</span> v11 = <span class="number">-1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> idx = <span class="number">0</span>; idx &lt; <span class="number">16</span>; idx++) &#123;</span><br><span class="line">                    v11 = magic_arr[(<span class="type">uint8_t</span>)(v11 ^ cstr[idx])] ^ (v11 &gt;&gt; <span class="number">8</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ((~v11) == <span class="number">0xF52E0765</span>) &#123;  </span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%c %c %c\n&quot;</span>, i, j, k);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后的flag:421KCTF381654729</p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> -加解密 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ezam</title>
      <link href="/2022/05/24/ezam%EF%BC%88ollvm%20%E8%BF%B7%E5%AE%AB%20%E8%BF%9B%E5%88%B6%EF%BC%89/"/>
      <url>/2022/05/24/ezam%EF%BC%88ollvm%20%E8%BF%B7%E5%AE%AB%20%E8%BF%9B%E5%88%B6%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>题目打开<br /></p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082339933.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082339933.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p><br />标准的ollvm混肴，用脚本两次去除<br /></p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082339395.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082339395.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br /><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082339683.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082339683.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br /></p><p>得到正常的程序<br /></p><p><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082340650.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082340650.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="></p><p><br /><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082343947.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082343947.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br />初步分析是以为多项式相加，疏忽了v17以及前面一大段数据的初始化。想着用z3硬解失败了。<br />主要逻辑为读取输入，判断是否为数字，然后转换成四进制，走迷宫。<br />前面的一大段加密是初始化迷宫地图v17，我们可以动调得到一个16*28的迷宫：（做题多尝试</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span></span><br></pre></td></tr></table></figure><p>下面看一下 sub_400670 函数 ，结合动调，是十进制转四进制算法。<br /><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082342374.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082342374.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br />下面就是迷宫出走方式<br /><img src="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082342140.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/1ens/blogImages/imgs/202205082342140.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="><br />得到两条路径，根据函数判断路径长度是45，所以是上面那条<br />232222322330030000303322223333333222233333333<br />232222322330030000303322222222222333333300033333333<br />然后四进制转十进制得到flag</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">def <span class="title">anyToDecimal</span><span class="params">(num,n)</span>:</span></span><br><span class="line"><span class="function">   baseStr =</span> &#123;<span class="string">&quot;0&quot;</span>:<span class="number">0</span>,<span class="string">&quot;1&quot;</span>:<span class="number">1</span>,<span class="string">&quot;2&quot;</span>:<span class="number">2</span>,<span class="string">&quot;3&quot;</span>:<span class="number">3</span>,<span class="string">&quot;4&quot;</span>:<span class="number">4</span>,<span class="string">&quot;5&quot;</span>:<span class="number">5</span>,<span class="string">&quot;6&quot;</span>:<span class="number">6</span>,<span class="string">&quot;7&quot;</span>:<span class="number">7</span>,<span class="string">&quot;8&quot;</span>:<span class="number">8</span>,<span class="string">&quot;9&quot;</span>:<span class="number">9</span>,</span><br><span class="line">              <span class="string">&quot;a&quot;</span>:<span class="number">10</span>,<span class="string">&quot;b&quot;</span>:<span class="number">11</span>,<span class="string">&quot;c&quot;</span>:<span class="number">12</span>,<span class="string">&quot;d&quot;</span>:<span class="number">13</span>,<span class="string">&quot;e&quot;</span>:<span class="number">14</span>,<span class="string">&quot;f&quot;</span>:<span class="number">15</span>,<span class="string">&quot;g&quot;</span>:<span class="number">16</span>,<span class="string">&quot;h&quot;</span>:<span class="number">17</span>,<span class="string">&quot;i&quot;</span>:<span class="number">18</span>,<span class="string">&quot;j&quot;</span>:<span class="number">19</span>&#125;</span><br><span class="line">   new_num = <span class="number">0</span></span><br><span class="line">   nNum = <span class="built_in">len</span>(num) - <span class="number">1</span></span><br><span class="line">   <span class="keyword">for</span> i in num:</span><br><span class="line">       new_num = new_num  + baseStr[i]*<span class="built_in">pow</span>(n,nNum)</span><br><span class="line">       nNum = nNum <span class="number">-1</span></span><br><span class="line">   <span class="built_in">print</span>(new_num)</span><br><span class="line"></span><br><span class="line"><span class="built_in">anyToDecimal</span>(<span class="string">&#x27;232222322330030000303322223333333222233333333&#x27;</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure><p> flag{902741462666576198076399615}</p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 迷宫 </tag>
            
            <tag> 进制 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
